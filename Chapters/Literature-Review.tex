% !tex root = ../Thesis.tex

This literature review attempts to cover all the subjects relevant to pitch
correction. Music theory is investigated first, covering the topics of human pitch
perception and tuning. This section attempts to determine what it means for a
pitch to be correct and how this relates to frequency. The idea is to get a list
of correct frequencies derived from a tuning system. After it is well-known what
is musically considered to be a correct pitch, the general structure of how pitch
correction is approached is investigated. This structure naturally splits up into
modules and each module is investigated further.

\section{Music Theory}

The intent of this section is to come up with a definition of what will be a
considered correct pitch. Some foundational work is required to define basic
musical concepts in a rigorous way. To start we need to define exactly what is
meant by a musical note.

A note is a sound made from a musical instrument. It has a pitch, volume, timbre
and length. These are the characteristics a musician would consider when composing
a piece of music. Each of these characteristics have a more rigorous scientific
counterpart they are related to. Pitch relates to frequency; Volume relates to
amplitude; timbre relates to harmonic content and length relates to duration. The
characteristic pair relevant to pitch correction is the pitch and frequency pair
and needs to be covered in more depth.

\begin{wrapfigure}{L}{0.5\textwidth}
\includegraphics[width=0.5\textwidth,trim={1mm 0mm 20mm 8mm},clip]{Frequency-Vs-Pitch}
\caption{"Frequency vs Pitch"}
\label{fig:FrequencyVsPitch}
\end{wrapfigure}

Pitch and frequency are terms often used interchangeably but does not refer to the
same concept. Pitch is a \textit{sensation} experienced by humans when they hear
notes containing frequencies between 31 Hz and 17.6 kHz\cite{Hearing}. The
sensation of pitch is scaled on a subjective ``high'' and ``low'' scale. The
higher the frequency, the higher the pitch perceived and the lower the frequency,
the lower the pitch perceived. This relationship between pitch and frequency is
generally considered to be logarithmic. Slight deviations from the expected
logarithmic relationship was found\cite{PitchVsFrequency} but was deemed minor
and unnecessary to incorporate for this project.

In Figure \ref{fig:FrequencyVsPitch} the relationship of frequency and pitch is
shown. Pitch is generally denoted by letters ranging from A to G with
sharps(\musSharp) and flats(\musFlat) called accidentals.  This is due to a long
history of convention and is irrelevant for now. The main takeaway is that the
perceived change in pitch is constant for each successive note. From this graph it
can be seen that frequency is exponentially dependent on pitch, or inversely,
pitch is logarithmically dependent on frequency.

From Figure \ref{fig:FrequencyVsPitch} a list of correct frequencies is obtained.
The method by which this list is obtained, originates from a concept called pitch
harmony. Two notes sounds good or in tune if their frequencies produce a simple
ratio\cite{Harmony}. For example an octave produces a ratio of 1:2 and a perfect
5th produces a ratio of 3:2. Figure \ref{fig:Harmony} shows how these two
harmonies are seen when their waveforms are plotted. The superposition created by
the two notes creating the interval has a short repeating pattern. The fact that
this pattern is short corresponds to the property of a simple ratio of
frequencies.  This short pattern/simple ratio is the origin of why two notes sound
harmonious.

\begin{figure}[h]
\centering
{\bf Octave Interval}
\begin{tabular}{c c c}
	\includegraphics[align=c, width=0.4\textwidth,
		trim={3.5cm 0 3.5cm 0},clip]
		{HarmonyOctaveSeparate}

	& \huge$\rightarrow$ &
	\includegraphics[align=c, width=0.4\textwidth,
		trim={3.5cm 0 3.5cm 0},clip]
		{HarmonyOctaveSuper}\\
\end{tabular}

\centering

{\bf Fifth Interval}
\begin{tabular}{c c c}
	\includegraphics[align=c, width=0.4\textwidth,
		trim={3.5cm 0 3.5cm 0},clip]
		{HarmonyFifthSeparate}
	& \huge$\rightarrow$ &
	\includegraphics[align=c, width=0.4\textwidth,
		trim={3.5cm 0 3.5cm 0},clip]
		{HarmonyFifthSuper}\\
\end{tabular}
\caption{Harmonic interference of two intervals}
\label{fig:Harmony}
\end{figure}

This concept of harmony gives a simple method to start creating a list of
frequencies that would sound good together. This list is created by starting with
an arbitrary frequency (440 Hz) and using these simple harmonic ratio's to create
a scale. In table \ref{tab:JustTuning} a list of these ratios and corresponding
interval names are given. This is referred to as {\it just tuning}. This tuning
method was naturally discovered because it corresponds to the different modes by
which a string vibrates when plucked\cite{Strings}.

\begin{table}[h]
\centering
\caption{Interval Names and Ratio's of Just Tuning}
\begin{tabu} to \textwidth { | X[l] | X[c] | X[r] | }
	\hline \bf Interval Name & \bf Ratio  & Frequency relative to 440 Hz \\
	\hline Unison & 1/1 = 1.000 & 440 Hz \\
	\hline Minor Second & 16/15 = 1.067 & 469 Hz \\
	\hline Major Second & 9/8 = 1.125 & 495 Hz \\
	\hline Minor Third & 6/5 = 1.200 & 528 Hz \\
	\hline Major Third & 5/4 = 1.250 & 550 Hz \\
	\hline Perfect Fourth & 4/3 = 1.333 & 587 Hz \\
	\hline Tritone & 7/5 = 1.400 & 616 Hz \\
	\hline Perfect Fifth & 3/2 = 1.500 & 660 Hz \\
	\hline Minor Sixth & 8/5 = 1.600 & 704 Hz \\
	\hline Major Sixth & 5/3 = 1.667 & 733 Hz \\
	\hline Minor Seventh & 15/8 = 1.778 & 782 Hz \\
	\hline Major Seventh & 15/8 = 1.875 & 825 Hz \\
	\hline Octave & 2/1 = 2.000 & 880 Hz \\
	\hline
\end{tabu}
\label{tab:JustTuning}
\end{table}

Unfortunately this just tuning method posed a problem when harpsichords and
clavichords (piano-like instruments) were introduced. These instruments required
to be in tune for any starting note. For a tuning system to allow this, a small
interval is required that touches all the wanted intervals when each successive
note is found using this small interval. Since pitch is logarithmically
dependent on frequency, we require a single real number, r, raised to the power of
a subset, n, of positive integers such that the result contains all the desired
interval ratios. Equation \ref{eq:HarmonyRequirement} shows what is required in
unambiguous notation.

\begin{equation}\label{eq:HarmonyRequirement}
	\exists r \in \mathbb{R} \text{ s.t. }
	R \subseteq \{ r^n | n \in \mathbb{N}_0 \}
	\text{ where } R = \{ \frac{1}{1}, \frac{16}{15}, \frac{9}{8}, \frac{6}{5}, \dots \}
\end{equation}

This in not possible and is proved in Appendix A. The best one can do is choose
which interval to keep perfect across all starting notes and choose a sufficiently
small sub-division such that each of the wanted harmonic ratio's is close enough
to an available note such that it is imperceptible to the listener. This is
exactly what equal tempered tuning does. The interval kept constant is the octave
and it is divided into 12 sub-intervals called semitones.  Each semitone interval
is equal to $\sqrt[12]{2}$. This interval has the property of when successively
applied 12 times it produces an octave interval. It also very closely matches all
the required just tuning ratios found in table \ref{tab:JustTuning}.

\begin{table}[h]
\centering
\caption{Interval Names and Ratio's of Equal Tempered Tuning}
\begin{tabu} to \textwidth { | X[l] | X[c] | X[r] | }
	\hline \bf Interval Name & \bf Ratio  & Frequency relative to 440 Hz \\
	\hline Unison & $(\sqrt[12]{2})^0 = 1.000$ & 440 Hz \\
	\hline Minor Second & $(\sqrt[12]{2})^1 = 1.059$ & 466 Hz \\
	\hline Major Second & $(\sqrt[12]{2})^2 = 1.122$ & 494 Hz \\
	\hline Minor Third & $(\sqrt[12]{2})^3 = 1.189$ & 523 Hz \\
	\hline Major Third & $(\sqrt[12]{2})^4 = 1.259$ & 554 Hz \\
	\hline Perfect Fourth & $(\sqrt[12]{2})^5 = 1.334$ & 587 Hz \\
	\hline Tritone & $(\sqrt[12]{2})^6 = 1.414$ & 622 Hz \\
	\hline Perfect Fifth & $(\sqrt[12]{2})^7 = 1.498$ & 659 Hz \\
	\hline Minor Sixth & $(\sqrt[12]{2})^8 = 1.587$ & 598 Hz \\
	\hline Major Sixth & $(\sqrt[12]{2})^9 = 1.681$ & 740 Hz \\
	\hline Minor Seventh & $(\sqrt[12]{2})^{10} = 1.781$ & 784 Hz \\
	\hline Major Seventh & $(\sqrt[12]{2})^{11} = 1.887$ & 831 Hz \\
	\hline Octave & $(\sqrt[12]{2})^{12} = 2.000$ & 880 Hz \\
	\hline
\end{tabu}
\label{tab:EqualTemper}
\end{table}

Table \ref{tab:EqualTemper} shows the modern equal tempered tuning ratios and
their related interval names. For all western scales a subset of these frequencies
are taken to produce the desired scale. Figure \ref{fig:JustVsEqual} shows a
scatter plot of the ratio's of just tuning and equal tempered tuning and a plot of
the percentage error for each note. It can be seen that for each just tuning ratio
needed, an equal tempered tuning note is not far off. The largest error that the
equal tempered tuning scale has, is less than 2\%.  This is considered small
enough to be mostly imperceptible. This twelve tone equal temperament tuning
system is what most modern digital instruments are based on\cite{EqualUsage}.

\begin{figure}[h]
\begin{tabular}{c c}
	\includegraphics[align=c, width=0.5\textwidth]
		{EqualVsJust}

	\includegraphics[align=c, width=0.5\textwidth]
		{ErrorEqual}\\
\end{tabular}
\caption{Comparison of just tuning and equal tempered tuning}
\label{fig:JustVsEqual}
\end{figure}

Table \ref{tab:EqualTemper} finally gives us a definition of what is considered to
be correct frequency. Other tuning methods exist but since twelve tone equal
tempered tuning is the most used, it will be considered the objective of this
project. Now that the idea of a correct pitch is well-known, the general pitch
correction structure is investigated.

\section{General Pitch Correction Structure}

Start here

\color{red}
To Do:
\begin{itemize}
	\item Stages and sections needed e.g.:
	\begin{itemize}
		\item Segmentation/Windowing
		\item Frequency detection
		\item Decide where to shift
		\item Frequency scaling
	\end{itemize}
	\item Add a flow diagram
\end{itemize}
\color{black}

\section{Segmentation}

\color{red}
To do:
\begin{itemize}
	\item Describe what segmentation is and why it is necessary
	\item Describe stages
	\begin{itemize}
		\item Split (overlap)
		\item Do computation
		\item Stitch (overlap and add)
	\end{itemize}
	\item Reason to overlap and size of overlapping (TRADE-OFF)
	\item Window size (TRADE-OFF)
	\begin{itemize}
		\item Small means low resolution
		\item Large means latency
		\item Small generally means more computation
	\end{itemize}
	\item Properties to preserve relevant to real time auto tuning
\end{itemize}
\color{black}

\section{Frequency Detection}

\color{red}
To do:
\begin{itemize}
	\item Explain that there is no single go-to method
	\item Different methods have different characteristics
	\item What is important for this application
	\item Give overview of which methods will be investigated
\end{itemize}
\color{black}

\subsection{Zero Crossing Method}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}

\subsection{Periodogram Method}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}

\subsection{Max FFT Method}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}

\subsection{YIN's Method}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}

\section{Frequency Scaling}

\color{red}
To do:
\begin{itemize}
	\item General approach is to expand/extrapolate frequency
	\item Time domain approaches and frequency domain approaches
	\item Introduce two approaches Phase Vocoder and pitch synchronous overlap and add
\end{itemize}
\color{black}

\subsection{Phase Vocoder}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}

\subsection{PSOLA}

\color{red}
To do:
\begin{itemize}
	\item Describe method roughly
	\item More in depth description comes in implementation section
\end{itemize}
\color{black}
